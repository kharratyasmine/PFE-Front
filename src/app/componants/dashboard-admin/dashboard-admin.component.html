<div class="dashboard-container">
  <div class="dashboard-header">

    <div class="header-content">
      <div class="title-section">
        <div class="icon-title-group">
          <i class="fas fa-chart-line"></i>
          <h2>{{ 'dashboard for' | translate }} '{{selectedProject?.name || ("project name" | translate)}}'</h2>
        </div>

        <button mat-raised-button color="primary" class="export-button" (click)="exportDashboard()"
          [disabled]="!selectedProject">
          <i class="fas fa-file-excel"></i>
          <span>{{ 'export' | translate }}</span>
        </button>
      </div>
      <div class="filters-section">
        <div class="filter-group">
          <mat-form-field class="year-filter">
            <mat-label><i class="fas fa-calendar"></i> {{ 'filter by year' | translate }}</mat-label>
            <mat-select [(value)]="selectedYear" (selectionChange)="onYearChange($event.value)">
              <mat-option [value]="null">{{ 'all years' | translate }}</mat-option>
              <mat-option *ngFor="let year of yearsList" [value]="year">{{ year }}</mat-option>
            </mat-select>
          </mat-form-field>

          <mat-form-field class="project-filter" *ngIf="selectedYear">
            <mat-label><i class="fas fa-project-diagram"></i> {{ 'select project' | translate }}</mat-label>
            <mat-select [(value)]="selectedProject" (selectionChange)="onProjectChange($event)">
              <mat-option [value]="null">{{ 'all projects' | translate }}</mat-option>
              <mat-option *ngFor="let project of projects" [value]="project">
                {{project.name}}
              </mat-option>
            </mat-select>
          </mat-form-field>

          <mat-form-field class="devis-filter" *ngIf="selectedProject">
            <mat-label><i class="fas fa-file-invoice"></i> {{ 'select quote' | translate }}</mat-label>
            <mat-select [(value)]="selectedDevis" (selectionChange)="onDevisChange($event)">
              <mat-option [value]="null">{{ 'all quotes' | translate }}</mat-option>
              <mat-option *ngFor="let devis of devisList" [value]="devis">
                {{devis.reference}}
              </mat-option>
            </mat-select>
          </mat-form-field>
        </div>
      </div>
    </div>
  </div>

  <div class="dashboard-content">
    <div *ngFor="let quarter of [1,2,3,4]" class="quarter-section">
      <div class="quarter-header">
        <i class="fas fa-chart-pie"></i>
        {{ 'quarter' | translate }} {{quarter}} {{ 'year' | translate }}
      </div>
      <div class="quarter-charts">
        <div class="chart-container">
          <canvas id="workloadChartQ{{quarter}}"></canvas>
          <div class="chart-label">
            <i class="fas fa-tasks"></i>
            {{ 'monthly workload' | translate }}
          </div>
        </div>
        <div class="chart-container">
          <canvas id="effortChartQ{{quarter}}"></canvas>
          <div class="chart-label">
            <i class="fas fa-chart-line"></i>
            {{ 'project effort progress' | translate }}
          </div>
        </div>
      </div>
    </div>
  </div>
</div>