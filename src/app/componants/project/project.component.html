<div class="container">
  <h2 class="text-center mt-3">üìå {{ 'Project List' | translate }}</h2>

  <!-- üîó Fil d‚ÄôAriane -->
  <nav aria-label="breadcrumb" class="mb-3">
    <ol class="breadcrumb bg-light p-2 rounded shadow-sm">
      <li class="breadcrumb-item">
        <a routerLink="/dashboard">üè† {{ 'DASHBOARD' | translate }}</a>
      </li>
      <li class="breadcrumb-item active" aria-current="page">
        {{ 'Project List' | translate }}
      </li>
    </ol>
  </nav>

  <!-- üîç Barre de recherche et actions -->
  <div class="d-flex justify-content-between align-items-center mb-3">
    <input type="text" (input)="searchProject($event)" placeholder="üîç {{ 'Search Project' | translate }}"
      class="form-control" style="width: 250px;" />
    <div>
      <button class="btn btn-outline-primary me-2" (click)="downloadExcel()">
        <i class="fas fa-download"></i>
      </button>
      <button class="btn btn-outline-success" (click)="openModal()"> <i class="fas fa-plus"></i> {{ 'Add Project' | translate }}</button>
    </div>
  </div>

  <!-- üìã Tableau -->
  <table class="table table-bordered table-hover text-center shadow-sm">
    <thead>
      <tr>
        <th>{{ 'Project Name' | translate }}</th>
        <th>{{ 'DESCRIPTION' | translate }}</th>
        <th>{{ 'Project Type' | translate }}</th>
        <th>{{ 'Start_Date' | translate }}</th>
        <th>{{ 'End Date' | translate }}</th>
        <th>{{ 'STATUS' | translate }}</th>
        <th>{{ 'CLIENT' | translate }}</th>
        <th>{{ 'ACTIVITY' | translate }}</th>
        <th>{{ 'TECHNOLOGIES' | translate }}</th>
        <th>{{ 'ACTIONS' | translate }}</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let project of filteredProjects | paginate: { itemsPerPage: itemsPerPage, currentPage: currentPage }">
        <td>{{ project?.name }}</td>
        <td>{{ project?.description }}</td>
        <td>{{ project?.projectType }}</td>
        <td>{{ project?.startDate | date: 'yyyy-MM-dd' }}</td>
        <td>{{ project?.endDate | date: 'yyyy-MM-dd' }}</td>
        <td>{{ getStatusLabel(project.status) }}</td>
        
        <td>
          <div *ngFor="let name of project.client?.salesManagers" class="d-block mb-1">
            {{ name || ('NO_CLIENT' | translate)}}
          </div>
        </td>
        <td>{{ project?.activity }}</td>
        <td>{{ project?.technologie }}</td>
        <td>
          <a [routerLink]="['/project', project.id]" class="btn btn-outline-secondary btn-sm me-2">
            <i class="fas fa-eye"></i>
          </a>
          <button class="btn btn-outline-success btn-sm me-2" (click)="openModal(project)">
            <i class="fas fa-pencil-alt"></i>
          </button>
          <button class="btn btn-outline-danger btn-sm" (click)="deleteProject(project.id!)">
            <i class="fas fa-trash"></i>
          </button>
        </td>
      </tr>
    </tbody>
  </table>

  <pagination-controls (pageChange)="currentPage = $event"></pagination-controls>

<div class="modal fade" id="projectModal" tabindex="-1" aria-labelledby="projectModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg modal-dialog-centered modal-dialog-scrollable">
    <div class="modal-content">

      <div class="modal-header">
        <h5 class="modal-title" id="projectModalLabel">
          {{ selectedProject.id ? ('edit project' | translate) : ('add project' | translate) }}
        </h5>
        <button type="button" class="btn-close" (click)="closeModal()" aria-label="Close"></button>
      </div>

      <div class="modal-body">
        <div class="mb-3">
          <label>{{ 'Project name' | translate }}</label>
          <input class="form-control" type="text" [(ngModel)]="selectedProject.name" name="name" required />
        </div>

        <div class="mb-3">
          <label>{{ 'Description' | translate }}</label>
          <textarea class="form-control" [(ngModel)]="selectedProject.description" name="description" required></textarea>
        </div>

        <div class="mb-3">
          <label>{{ 'Project type' | translate }}</label>
          <input class="form-control" type="text" [(ngModel)]="selectedProject.projectType" name="projectType" required />
        </div>

        <div class="mb-3">
          <label>{{ 'Start date' | translate }}</label>
          <input class="form-control" type="date" [(ngModel)]="selectedProject.startDate" name="startDate" required />
        </div>

        <div class="mb-3">
          <label>{{ 'End date' | translate }}</label>
          <input class="form-control" type="date" [(ngModel)]="selectedProject.endDate" name="endDate" required />
        </div>

        <div class="mb-3">
          <label>{{ 'Status' | translate }}</label>
          <select class="form-select" [(ngModel)]="selectedProject.status" name="status">
            <option *ngFor="let s of statusList" [ngValue]="s">{{ getStatusLabel(s) }}</option>
          </select>
        </div>

        <div class="mb-3">
          <label>{{ 'Client' | translate }}</label>
          <select class="form-select" [(ngModel)]="selectedProject.clientId" name="clientId">
            <option [ngValue]="null">-- {{ 'select client' | translate }} --</option>
            <option *ngFor="let client of clients" [value]="client.id">
              {{ client.salesManagers }} - {{ client.company }}
            </option>
          </select>
        </div>

        <div class="mb-3">
          <label>{{ 'User' | translate }}</label>
          <select class="form-select" [(ngModel)]="selectedProject.userId" name="userId">
            <option [ngValue]="null">-- {{ 'select user' | translate }} --</option>
            <option *ngFor="let user of users" [value]="user.id">
              {{ user.firstname }} {{ user.lastname }}
            </option>
          </select>
        </div>

        <div class="mb-3">
          <label>{{ 'Activity' | translate }}</label>
          <input class="form-control" type="text" [(ngModel)]="selectedProject.activity" name="activity" />
        </div>

        <div class="mb-3">
          <label>{{ 'Technologies' | translate }}</label>
          <input class="form-control" type="text" [(ngModel)]="selectedProject.technologie" name="technologie" />
        </div>
      </div>

      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" (click)="closeModal()">‚ùå {{ 'cancel' | translate }}</button>
        <button type="button" class="btn btn-primary" (click)="saveProject()">‚úÖ {{ 'save' | translate }}</button>
      </div>
    </div>
  </div>
</div>

  
</div>
